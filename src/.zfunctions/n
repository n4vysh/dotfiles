n ()
{
	# Block nesting of nnn in subshells
	[ "${NNNLVL:-0}" -eq 0 ] || {
			echo "nnn is already running"
			return
	}

	# To cd on quit only on ^G
	NNN_TMPFILE="${XDG_CONFIG_HOME:-$HOME/.config}/nnn/.lastd"

	# Unmask ^Q to Quit nnn
	stty start undef

	# The command builtin allows one to alias nnn to n, if desired, without
	# making an infinitely recursive alias
	command nnn "$@"

	[ ! -f "$NNN_TMPFILE" ] || {
			. "$NNN_TMPFILE"
			rm -f -- "$NNN_TMPFILE" > /dev/null
	}
}
